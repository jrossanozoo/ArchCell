IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[Funciones].[ObtenerDescriptorComprobanteComprobantesYGruposDeCaja]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [Funciones].[ObtenerDescriptorComprobanteComprobantesYGruposDeCaja];
GO;

CREATE FUNCTION [Funciones].[ObtenerDescriptorComprobanteComprobantesYGruposDeCaja]
( @TipoDeComprobante varchar(2) )
RETURNS varchar (50)
AS
BEGIN
declare @retorno varchar (50)
set @retorno = 
case @TipoDeComprobante
	 when '00' then 'Facturas A'
	 when '01' then 'Facturas B'
	 when '23' then 'Facturas C'
	 when '02' then 'Notas de crédito A'
	 when '03' then 'Notas de crédito B'
	 when '24' then 'Notas de crédito C'
	 when '04' then 'Notas de débito A'
	 when '05' then 'Notas de débito B'
	 when '25' then 'Notas de débito C'
	 when '07' then 'Ticket Factura A'
	 when '08' then 'Ticket Factura B'
	 when '26' then 'Ticket Factura C'
	 when '40' then 'Ticket Factura'
	 when '09' then 'Ticket Notas de crédito A'
	 when '10' then 'Ticket Notas de crédito B'
	 when '27' then 'Ticket Notas de crédito C'
	 when '41' then 'Ticket Notas de crédito'
	 when '11' then 'Ticket Notas de débito A'
	 when '12' then 'Ticket Notas de débito B'
	 when '28' then 'Ticket Notas de débito C'
	 when '50' then 'Facturas de Compra A'
	 when '51' then 'Facturas de Compra B'
	 when '52' then 'Facturas de Compra C'
	 when '70' then 'Facturas de Compra M'
	 when '42' then 'Facturas de Compra'
	 when '44' then 'Facturas de Compra E'
	 when '64' then 'Notas de débito Compra A'
	 when '65' then 'Notas de débito Compra B'
	 when '66' then 'Notas de débito Compra C'
	 when '71' then 'Notas de débito Compra M'
	 when '45' then 'Notas de débito Compra E'
	 when '67' then 'Notas de crédito Compra A'
	 when '68' then 'Notas de crédito Compra B'
	 when '69' then 'Notas de crédito Compra C'
	 when '72' then 'Notas de crédito Compra M'
	 when '43' then 'Notas de crédito Compra'
	 when '46' then 'Notas de crédito Compra E'
	 when '53' then 'Facturas Electrónicas A'
	 when '54' then 'Facturas Electrónicas B'
	 when '55' then 'Facturas Electrónicas C'
	 when '56' then 'Notas de crédito Electrónicas A'
	 when '57' then 'Notas de crédito Electrónicas B'
	 when '58' then 'Notas de crédito Electrónicas C'
	 when '59' then 'Notas de débito Electrónicas A'
	 when '60' then 'Notas de débito Electrónicas B'
	 when '61' then 'Notas de débito Electrónicas C'
	 when '83' then 'Facturas Electrónicas  MiPyME A'
	 when '84' then 'Facturas Electrónicas  MiPyME B'
	 when '85' then 'Facturas Electrónicas  MiPyME C'
	 when '86' then 'Notas de crédito Electrónicas MiPyME A'
	 when '87' then 'Notas de crédito Electrónicas MiPyME B'
	 when '88' then 'Notas de crédito Electrónicas MiPyME C'
	 when '89' then 'Notas de débito Electrónicas MiPyME A'
	 when '90' then 'Notas de débito Electrónicas MiPyME B'
	 when '91' then 'Notas de débito Electrónicas MiPyME C'
	 when '76' then 'Facturas Electrónicas Exportación'
	 when '77' then 'Nota de crédito Electrónica Exportación'
	 when '78' then 'Nota de débito Electrónica Exportación'
	 when '79' then 'Facturas de Exportación'
	 when '80' then 'Notas de crédito de Exportación'
	 when '81' then 'Notas de débito de Exportación'
	 when '13' then 'Recibos X'
	 when '14' then 'Boleta Fiscal'
	 when '15' then 'Factura'
	 when '16' then 'Notas de crédito'
	 when '17' then 'Boleta Preimpresa'
	 when '18' then 'Nota de crédito preimpresa'
	 when '20' then 'Factura Electrónica'
	 when '21' then 'Nota de Crédito'
	 when '06' then 'Comprobantes de caja'
	 when '63' then 'Orden de Pago X'
	 when '62' then 'Pago X'
	 when '82' then 'Otros Pagos'
	 when '99' then 'Apertura de Caja'
	 when '96' then 'Ajuste de Caja'
	 when '97' then 'Canje de valores'
	 when '31' then 'Facturas M'
	 when '32' then 'Notas de crédito M'
	 when '33' then 'Notas de débito M'
	 when '34' then 'Facturas Electrónicas M'
	 when '35' then 'Notas de crédito Electrónicas M'
	 when '36' then 'Notas de débito Electrónicas M'
	 when '37' then 'Ticket Factura M'
	 when '38' then 'Ticket Notas de crédito M'
	 when '39' then 'Ticket Notas de débito M'
	else ''
end
return @retorno
END