IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[Funciones].[ObtenerIdentificadorDeEntidad]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))
DROP FUNCTION [Funciones].[ObtenerIdentificadorDeEntidad];
GO;

CREATE FUNCTION [Funciones].[ObtenerIdentificadorDeEntidad]
( @Entidad varchar(36) )
RETURNS varchar (6)
AS
BEGIN
declare @retorno varchar (6)
set @retorno = 
case upper(@Entidad)
	when 'ARTICULO' then '001'
	when 'PROVEEDOR' then '002'
	when 'MATERIAL' then '003'
	when 'COLOR' then '004'
	when 'LISTADEPRECIOS' then '005'
	when 'VALOR' then '006'
	when 'VENDEDOR' then '007'
	when 'CLIENTE' then '008'
	when 'FACTURA' then '011'
	when 'STOCKCOMBINACION' then '012'
	when 'PROVINCIA' then '013'
	when 'CORREDOR' then '014'
	when 'BANCO' then '015'
	when 'SUCURSAL' then '016'
	when 'DOCUMENTOPROPIO' then '017'
	when 'PRECIODEARTICULO' then '018'
	when 'TICKETFACTURA' then '019'
	when 'NOTADECREDITO' then '020'
	when 'NOTADEDEBITO' then '021'
	when 'TICKETNOTADECREDITO' then '022'
	when 'TICKETNOTADEDEBITO' then '023'
	when 'STOCKARTICULOS' then '024'
	when 'MONEDA' then '025'
	when 'ORIGENDEDATOS' then '027'
	when 'ENTIDADFINANCIERA' then '028'
	when 'MOTIVO' then '030'
	when 'REMITO' then '032'
	when 'CAJAAUDITORIA' then '033'
	when 'CAJAESTADO' then '034'
	when 'CAJASALDOS' then '035'
	when 'MOVIMIENTODECAJA' then '036'
	when 'CONCEPTOCAJA' then '037'
	when 'COMPROBANTEDECAJA' then '038'
	when 'GRUPOVALOR' then '039'
	when 'MODIFICACIONPRECIOS' then '040'
	when 'MOVIMIENTODESTOCK' then '043'
	when 'BUZON' then '044'
	when 'PAISES' then '045'
	when 'TALONARIO' then '046'
	when 'NUMERACIONES' then '047'
	when 'DEVOLUCION' then '048'
	when 'INFORMACIONADICIONALCOMPVTAS' then '049'
	when 'PERCEPCION' then '050'
	when 'AJUSTEDESTOCK' then '051'
	when 'AGRUPAMIENTO' then 'AGR'
	when 'BASEDEDATOS' then '052'
	when 'CTACTE' then '053'
	when 'RECIBO' then '054'
	when 'MEMORIA' then 'MEM'
	when 'DISENOIMPRESION' then 'IMP'
	when 'TIPOAREAIMPRESION' then 'ARE'
	when 'ESTILOIMPRESION' then 'ESI'
	when 'TIPOATRIBUTOIMPRESION' then 'ATR'
	when 'SELECCIONDISENOIMPRESION' then 'SDI'
	when 'DISENOEXPO' then 'EXP'
	when 'DESCUENTO' then 'DES'
	when 'FORMATOEXPORTACION' then 'FOE'
	when 'TIPOAREAEXPORTACION' then 'TAE'
	when 'TIPOATRIBUTOSEXPORTACION' then 'TBE'
	when 'TIPOARCHIVOEXPORTACION' then 'THE'
	when 'TIPOREGISTROEXPORTACION' then 'TRE'
	when 'CONVERSION' then 'CDE'
	when 'CONVERSIONVALORES' then 'VCE'
	when 'EXPOAGRUPADAS' then 'EXA'
	when 'TIPOARCHIVOIMPORTACION' then 'THI'
	when 'IMPOAGRUPADAS' then 'IMA'
	when 'TIINVENTARIOACONT' then 'TIT'
	when 'TIINVENTARIOACONTDETALLE' then 'ITD'
	when 'TIINVENTARIOFISICO' then 'TIF'
	when 'TIINVENTARIOFISICODETALLE' then 'FIT'
	when 'TIDIFERENCIASDEINVENTARIO' then 'TIN'
	when 'TIDIFERENCIASDEINVENTARIODETALLE' then 'TID'
	when 'EQUIVALENCIA' then 'CBA'
	when 'REDONDEODEPRECIOS' then 'RED'
	when 'CONDICIONIMPO' then 'CON'
	when 'DISENOIMPO' then 'DIM'
	when 'PICKING' then 'PIK'
	when 'DATOSFISCALES' then 'DFI'
	when 'JURISDICCION' then 'JUR'
	when 'CAI' then 'CAI'
	when 'SCRIPT' then 'SCR'
	when 'VALEDECAMBIO' then 'VCB'
	when 'CONSUMOCLIENTE' then 'CCL'
	when 'LIMITECONSUMO' then 'LCN'
	when 'REGLASTRANSFERENCIAS' then 'RTR'
	when 'ERRORESCFIBM4610KC4' then 'KC4'
	when 'CODIGOPOSTAL' then 'CP8'
	when 'ACCIONESAUTOMATICAS' then 'AA'
	when 'SENIA' then 'SEN'
	when 'PEDIDO' then 'PED'
	when 'IMPRESIONDEETIQUETA' then 'IET'
	when 'CLASIFICACIONCLIENTE' then '203'
	when 'SENIAPENDIENTE' then 'SEP'
	when 'CHEQUE' then 'CH'
	when 'IMPUESTO' then 'IMS'
	when 'FACTURADECOMPRA' then 'FDC'
	when 'OPERADORADETARJETA' then '056'
	when 'CIERREDELOTE' then '057'
	when 'POS' then 'POS'
	when 'CUPON' then 'CUP'
	when 'PRESUPUESTO' then 'PRE'
	when 'TIPOIMPUESTO' then 'TIM'
	when 'TRANSPORTISTA' then 'TRA'
	when 'DATOSTARJETA' then 'DP2'
	when 'CALCULODEPRECIOS' then '041'
	when 'TRATAMIENTOCOMPROBANTES' then 'TCO'
	when 'FACTURAELECTRONICA' then '127'
	when 'NOTADECREDITOELECTRONICA' then '128'
	when 'NOTADEDEBITOELECTRONICA' then '129'
	when 'CAE' then 'FAE'
	when 'FAVORITOLISTADOS' then 'FVX'
	when 'CAEPORLOTE' then 'OFA'
	when 'COMPORTAMIENTOCODIGOSUGERIDOENTIDAD' then 'CCS'
	when 'ZUDESCARGALAN' then 'LAN'
	when 'INFORMACIONLISTADOS' then 'IAL'
	when 'CTACTECOMPRA' then '130'
	when 'ORDENDEPAGO' then 'ODP'
	when 'NOTADEDEBITOCOMPRA' then 'NDC'
	when 'NOTADECREDITOCOMPRA' then 'NCC'
	when 'SUCURSALBANCARIA' then '131'
	when 'CUENTABANCARIA' then '132'
	when 'CHEQUERA' then '133'
	when 'CHEQUEPROPIO' then 'CP'
	when 'ESTADOCONTROLADORFISCAL' then '140'
	when 'CANJEDECUPONES' then 'CDV'
	when 'CUPONESPENDIENTES' then 'CPN'
	when 'FACTURAELECTRONICAEXPORTACION' then 'FEE'
	when 'INCOTERMS' then 'INT'
	when 'UNIDADDEMEDIDA' then 'UDM'
	when 'UNIDADDEMEDIDAAFIP' then 'EUM'
	when 'PAISAFIP' then 'PAF'
	when 'MONEDAAFIP' then 'MAF'
	when 'NOTADECREDITOELECTRONICAEXPORTACION' then 'NEE'
	when 'NOTADEDEBITOELECTRONICAEXPORTACION' then 'DEE'
	when 'AGRUPAMIENTODEBUZONES' then 'ABZ'
	when 'IMPRIMIRCOMPROBANTEPORLOTE' then 'ICL'
	when 'FORMULA' then 'FOR'
	when 'SALTODECAMPO' then 'SDC'
	when 'COMISION' then 'COM'
	when 'CLASEDETARJETA' then 'CDT'
	when 'TIINVENTARIOFISICODETALLETMP' then 'FTT'
	when 'MERCADERIAENTRANSITO' then 'MTR'
	when 'MINIMOREPOSICION' then 'MIN'
	when 'LISTADOSPERSONALIZADOS' then 'LPZ'
	when 'REGISTRODEMANTENIMIENTO' then 'RAM'
	when 'PROMOCION' then 'PR0'
	when 'SELECCIONPARAINSERTAR' then 'SEI'
	when 'PAGO' then 'PAG'
	when 'AJUSTEDEESTADOS' then 'AES'
	when 'COMPROBANTEDERETENCIONES' then 'CDR'
	when 'CONVENIOMULTILATERAL' then 'CML'
	when 'PRESUPUESTODECOMPRA' then 'PDC'
	when 'PEDIDODECOMPRA' then 'PCO'
	when 'SOLICITUDDECOMPRA' then 'SOC'
	when 'REQUERIMIENTODECOMPRA' then 'RDC'
	when 'REMITODECOMPRA' then 'RCO'
	when 'CANCELACIONDECOMPRA' then 'CAC'
	when 'PROPIEDADESLISTADOS' then 'PLI'
	when 'AJUSTEDECUPON' then 'AJC'
	when 'BOLSASYCAJAS' then 'BYC'
	when 'AJUSTECCCLIENTE' then 'AJU'
	when 'AJUSTECCPROVEEDOR' then 'AJP'
	when 'CANCELACIONDESENIAS' then 'CDS'
	when 'GTIN' then 'GTI'
	when 'SITUACIONFISCAL' then 'STF'
	when 'PASAJEDESTOCK' then 'PST'
	when 'SELECCIONBASESARCHIVADAS' then 'SBA'
	when 'PRECARGAETIART' then 'PET'
	when 'NUEVOENBASEA' then 'NBA'
	when 'LISTADEPRECIOSCALCULADA' then 'LPC'
	when 'PADRONIIBB' then 'IIB'
	when 'REGISTRODEACTIVIDAD' then 'ACT'
	when 'CONCILIACIONDECAJA' then 'CCJ'
	when 'POOLDECLASE' then 'POO'
	when 'ACCESOAOBJETO' then 'AO'
	when 'EXPRESIONLISTADOPERSONALIZADO' then 'ELP'
	when 'CUPONESHUERFANOS' then 'CPH'
	when 'NOMENCLADORARBA' then 'NAR'
	when 'GRUPO' then 'GRP'
	when 'CLASIFICACIONARTICULO' then '205'
	when 'UNIDADDEMEDIDAARBA' then 'UMA'
	when 'REMITOELECTRONICO' then 'REL'
	when 'DESTINODESCARGACHEQUES' then 'DDC'
	when 'DESCARGADECHEQUES' then 'DCT'
	when 'FACTURADEEXPORTACION' then 'FMX'
	when 'NOTADECREDITODEEXPORTACION' then 'NCX'
	when 'NOTADEDEBITODEEXPORTACION' then 'NDX'
	when 'EDICIONIMPUESTOIVACOMPRAS' then 'EIC'
	when 'REGISTRODEBAJA' then 'RBL'
	when 'NOMBREDEFANTASIA' then 'NFA'
	when 'TIPODEDIRECCION' then 'TDD'
	when 'CONTACTO' then 'CNT'
	when 'TIPOCLIENTE' then 'TCL'
	when 'CATEGORIACLIENTE' then 'CGC'
	when 'DISCOVER' then 'DSC'
	when 'CRITERIOSVALORES' then 'CAV'
	when 'DESPACHODEIMPORTACION' then 'DDI'
	when 'SELECCIONDESPACHO' then 'SDD'
	when 'REGISTRODESALUDSERVIDORDEDATOS' then 'SQL'
	when 'REGIMENIMPOSITIVO' then 'REG'
	when 'CLASIFICACIONCONCEPTOPAGO' then 'CCP'
	when 'CONCEPTOPAGO' then 'CPA'
	when 'COMPROBANTEPAGO' then 'COP'
	when 'COMPROBANTEDERETENCIONESIVA' then 'CRI'
	when 'COMPROBANTEDERETENCIONESGANANCIAS' then 'CRG'
	when 'COMPROBANTEDERETENCIONESSUSS' then 'CRS'
	when 'CONDICIONDEPAGO' then 'CDP'
	when 'TIPODEOPERACIONAFIP' then 'TOA'
	when 'ASOCIACIONARTICULOSOPERACIONESAFIP' then 'AAO'
	when 'FERIADO' then 'FER'
	when 'REGISTRODEACTIVIDADDET' then 'ACD'
	when 'DATOSADICIONALESCOMPROBANTESA' then 'DAA'
	when 'MOTIVODATOSADICIONALESCOMPROBANTESA' then 'MDA'
	when 'AGRUPAMIENTOPUBLICACIONES' then 'APP'
	when 'CONCEPTOLIQUIDACIONTARJETA' then 'CLT'
	when 'LIQUIDACIONDIARIA' then 'LDT'
	when 'LIQUIDACIONMENSUAL' then 'LIQ'
	when 'PLANDECUENTAS' then 'CTA'
	when 'MAILPORLOTE' then 'MFA'
	when 'EMAIL' then 'MIL'
	when 'CUENTACORREO' then 'SMT'
	when 'COMPROBANTEDERETENCIONRECIBIDO' then 'CRR'
	when 'DATOSRETENCIONRECIBIDO' then 'DRR'
	when 'REPORTEELECTRONICO' then 'RPE'
	when 'COMPLETARDESDEVENTAS' then 'CVE'
	when 'CENTRODECOSTO' then 'CCO'
	when 'DISTRIBUCIONCENTRODECOSTO' then 'DCC'
	when 'ASIENTO' then 'ASI'
	when 'RAZONSOCIAL' then 'RAZ'
	when 'EJERCICIO' then 'EJR'
	when 'ASIGNARZBD' then 'ARB'
	when 'IMPDIRVAL' then 'IDV'
	when 'IMPDIRART' then 'IDA'
	when 'IMPDIRCLI' then 'IDC'
	when 'IMPDIRPRO' then 'IDP'
	when 'IMPDIRIMP' then 'IDI'
	when 'IMPDIRCAJ' then 'IDJ'
	when 'IMPDIRCON' then 'IDO'
	when 'IMPDIRDES' then 'IDD'
	when 'IMPDIROPE' then 'IDT'
	when 'IMPDIRLIQ' then 'IDQ'
	when 'IMPVERCC' then 'IVC'
	when 'IMPDIRCCA' then 'IDX'
	when 'IMPDIRCCC' then 'IDZ'
	when 'ASIENTOSPERIODICOS' then 'RAS'
	when 'APERTURAEJERCICIO' then 'ADE'
	when 'CONTABILIZACION' then 'CAT'
	when 'ASIENTOTIPO' then 'ATI'
	when 'CIERREEJERCICIO' then 'CEJ'
	when 'ENTREGADEMERCADERIAS' then 'EMC'
	when 'ECOMMERCE' then 'ECO'
	when 'CLIENTEECOMMERCE' then 'CEC'
	when 'OPERACIONECOMMERCE' then 'OEC'
	when 'COMPROBANTESECOMMERCE' then 'COE'
	when 'PUNTOSDEVENTA' then 'PVT'
	when 'DATOSADICIONALESSIPRIB' then 'DAS'
	when 'ARTICULOINCISODATOSADICIONALESSIPRIB' then 'ADA'
	when 'SERVICIOREST' then 'RST'
	when 'CLAVESECRETAREST' then 'PKR'
	when 'AGRUPALISTADOSPERSONALIZADOS' then 'ALP'
	when 'REPORTEAUDITORIACIERREZ' then 'ACZ'
	when 'MOTIVODESCUENTOYDEVOLUCION' then 'MDD'
	when 'CODIGOAUTORIZACIONDJCP' then 'DJC'
	when 'ARQUEODECAJA' then 'ARQ'
	when 'CODIGODESERVICIO' then 'COS'
	when 'TIPODEORDEN' then 'TDO'
	when 'ESTADOSDEINTERACCION' then 'EDI'
	when 'INTERACCIONDEORDEN' then 'INO'
	when 'ENTIDADADICIONAL1' then 'EA1'
	when 'ENTIDADADICIONAL2' then 'EA2'
	when 'ENTIDADADICIONAL3' then 'EA3'
	when 'ORDENDESERVICIO' then 'ODS'
	when 'SELECCIONORDENDESERVICIO' then 'SOS'
	when 'SELECCIONOPERACIONECOMMERCE' then 'SOP'
	when 'GESTIONVENDEDOR' then 'GDV'
	when 'FILTRARCOMPROBANTESACONTROLAR' then 'FCC'
	when 'COTIZACION' then 'NCZ'
	when 'EMAILENCOMPROBANTE' then 'EMM'
	when 'SELECCIONCOMPROBANTEASOCIADO' then 'SCA'
	when 'FACTURAELECTRONICADECREDITO' then 'FEM'
	when 'NOTADECREDITOELECTRONICADECREDITO' then 'CEM'
	when 'NOTADEDEBITOELECTRONICADECREDITO' then 'DEM'
	when 'CONFIRMACIONFECHAVTOMIPYME' then 'CFV'
	when 'NUEVOENTREGAONLINE' then 'NEO'
	when 'SELECCIONDISENOIMPORTACION' then 'SDO'
	when 'ENVIODEMENSAJERIA' then 'EME'
	when 'DATOSTAREAPROGRAMADAECOMMERCE' then 'TPE'
	when 'VALORESENTRANSITO' then 'VTR'
	when 'CONFIRMACIONVALORESENTRANSITO' then 'VTC'
	when 'DATOSTRANSACCIONBANCARIA' then 'DTB'
	when 'REGISTRODECUENTA' then 'RCT'
	when 'TRANSFERENCIAENTRECUENTAS' then 'TEC'
	when 'COMPLETARDATOSREGISTRO' then 'DCB'
	when 'CONCEPTOENTIDADFINANCIERA' then 'CEF'
	when 'MOVIMIENTOBANCARIO' then 'MBC'
	when 'CONCILIACIONES' then 'COB'
	when 'HERRAMIENTACONCILIACION' then 'HCB'
	when 'TIPODECOMPROBANTEDECOMPRA' then 'TCC'
	when 'DEUDADECHEQUES' then 'DCH'
	when 'CHEQUESDISPONIBLES' then 'CTD'
	when 'CODBARRAALTER' then 'CAB'
	when 'PREPARACIONDEMERCADERIA' then 'PRM'
	when 'FACTURAAGRUPADA' then 'FAG'
	when 'NOTADECREDITOAGRUPADA' then 'NAG'
	when 'NOTADEDEBITOAGRUPADA' then 'XAD'
	when 'DATOSADICIONALESSIRE' then 'DSI'
	when 'HERRAMIENTAAGRUPADORADEPACKS' then 'PCK'
	when 'LINKQRENETIQUETA' then 'LQR'
	when 'WEBHOOK' then 'WHK'
	when 'TIQUETDECAMBIO' then 'TDC'
	when 'PERSONALIZACIONDEENTIDADES' then 'PEN'
	when 'DIRECCIONENTREGAENCOMPROBANTE' then 'DIE'
	when 'REGISTROLIQUIDACIONCONSIGNACIONES' then 'RLC'
	when 'FECHACANCELACION' then 'FEC'
	when 'MARCA' then 'MAR'
	when 'ETIQUETASECOMMERCE' then 'ETE'
	when 'CATEGORIASECOMMERCE' then 'CTG'
	when 'CONFIGURACIONARTICULOECOMMERCE' then 'CED'
	when 'CATEGORIASGOOGLESHOPPING' then 'CGS'
	when 'APERTURAAUTOMATICAENTIDADES' then 'AAE'
	when 'OPEECOMENPROCESO' then 'CY3'
	when 'CAEA' then 'OCA'
	when 'CAEAINFORMA' then 'IMC'
	when 'MAQUINARIA' then 'MQP'
	when 'CONSUMOPRODUCCION' then 'CSM'
	when 'CLASIFICACIONPRODUCCION' then 'CLP'
	when 'RUBROPRODUCCION' then 'RBP'
	when 'TIPIFICACIONPRODUCCION1' then 'TP1'
	when 'TIPIFICACIONPRODUCCION2' then 'TP2'
	when 'VENDEDORENCOMPROBANTE' then 'VEC'
	when 'CONDICIONDEPAGOENCOMPROBANTE' then 'ECP'
	when 'INVENTARIO' then 'INV'
	when 'INSUMO' then 'INP'
	when 'CURVADEPRODUCCION' then 'CVP'
	when 'MOTIVODESCARTE' then 'MDE'
	when 'TALLER' then 'TLL'
	when 'PROCESOPRODUCCION' then 'PRP'
	when 'FILTRARCOMPROBANTESAINSERTAR' then 'FCI'
	when 'SELECOMPAINSERTAR' then 'SCI'
	when 'INFORMEVENTASLPS' then 'IVS'
	when 'SELECCHEQUETERCEROS' then 'SCT'
	when 'SELECHEQUEAINSERTAR' then 'SCH'
	when 'RETIRODEEFECTIVO' then 'RDE'
	when 'GESTIONCHCUSTODIA' then 'GCC'
	when 'GENERADORTOKEN' then 'CPT'
	when 'LISTADECOSTOSDEPRODUCCION' then 'LCP'
	when 'MODIFICACIONDECOSTOSDEPRODUCCION' then 'MCP'
	when 'COTIZACIONGESTIONDEORDENDEPRODUCCION' then 'CGO'
	when 'LIQUIDACIONDETALLER' then 'LTP'
	when 'COSTODEINSUMO' then '026'
	when 'PROCESARNCPENDIENTEPROMOBANCO' then 'PCB'
	when 'ALIVIODECAJA' then 'ADC'
	when 'ADT_ARTICULO' then 'AUD001'
	when 'ADT_STOCKCOMBINACION' then 'AUD012'
	when 'ADT_PRECIODEARTICULO' then 'AUD018'
	when 'ADT_STOCKARTICULOS' then 'AUD024'
	when 'ADT_DESCUENTO' then 'AUDDES'
	when 'ADT_CONSUMOCLIENTE' then 'AUDCCL'
	when 'ADT_LIMITECONSUMO' then 'AUDLCN'
	when 'ADT_ESTADOCONTROLADORFISCAL' then 'AUD140'
	else ''
end
return @retorno

END